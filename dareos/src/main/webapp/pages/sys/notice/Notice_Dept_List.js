/** * @module 消息管理 * @fuc 公告生效区域 * @version 1.1 * @author 张忠斌 */$(function(){	//维护和审核调用的是同一页面，只是按钮不同，所以需要设置	//审核页面需要隐藏的按钮	shBtnHidden(["edit","delete"]);	var selRowId = parent.document.getElementById("selRowId").value;	var state = parent.topcontent.document.getElementById("state" + selRowId).value;		if(state == '提交'){	   btnDisable(["edit","delete"]);	}	if(selRowId == null || '' == selRowId){	        btnDisable(["edit","delete"]);			return;	}		$("#delete").click(function(){		//查找当前是否有选中的记录		var checkBox = $("#ordertb tr:gt(0) input:checked");		if(checkBox.length<1){			parent.showErrorMsg("请至少选择一条记录");			return;		}		parent.showConfirm("您确认要删除吗","bottomcontent.multiRecDeletes();");	});	$("#edit").click(function(){        var checkBox = $("#ordertb tr:gt(0) input:checked");		var ids = "";		if(checkBox.length>0){			//获取所有选中的记录			checkBox.each(function(){				ids = ids+"'"+$(this).val()+"',";			});			ids = ids.substr(0,ids.length-1);		}		$("#MXIDS").val(ids);		$("#form1").attr("action","notice.shtml?action=toChildDeptEdit");		$("#form1").submit();	});		$("#allChecked").click(function(){		var flag = document.getElementById("allChecked").checked;		if(flag){			$("#ordertb :checkbox").attr("checked","true");		}else{			$("#ordertb :checkbox").removeAttr("checked");		}	});});function multiRecDeletes(){//查找当前是否有选中的记录	var checkBox = $("#ordertb tr:gt(0) input:checked");	//获取所有选中的记录	var ids = "";	checkBox.each(function(){		ids = ids+"'"+$(this).val()+"',";	});	ids = ids.substr(0,ids.length-1);		var selRowId = getSelRowId();		$.ajax({		url: "notice.shtml?action=childDeptDelete",		type:"POST",		dataType:"text",		data:{"MXIDS":ids,"NOTICEID":selRowId},		complete: function(xhr){			eval("jsonResult = "+xhr.responseText);			if(jsonResult.success===true){				parent.showMsgPanel("删除成功");				checkBox.parent().parent().remove();			}else{				parent.showErrorMsg(utf8Decode(jsonResult.messages));			}		}	});}function getSelRowId(){	return parent.document.getElementById("selRowId").value;}
